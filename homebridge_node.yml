# Playbook to setup homebridge role
---
  - name: Configure NFS Server
    hosts: 20-size.local
    remote_user: ansible
    vars_files:
     - vars/vars.yml
    become: yes
    
    
    tasks: 
      - name: Create folder in /whidbey/configs for each role
        file:
          path: "{{server_config_path}}{{item}}"
          state: directory
          mode: 0775
          owner: ansible
          group: docker
        loop:
          - homebridge

  - hosts: homebridge
    remote_user: ansible
    become: yes
    vars_files:
      - vars/vars.yml

    pre_tasks:
       
      - name: "Install pip, setuptools, virtualenv if not already"
        apt: 
           name:
#                 - python-pip
                - python-setuptools
                - virtualenv
           state: present
           update_cache: yes
    
      - name: "Install pyOpenSSL if not already"
        pip:
            name:
              - cryptography 
              - pyOpenSSL  # required for OpenSSL cert creation
            state: present

   
    roles:
      - role: common
        tags: common
      - role: docker
        tags: docker
      - role: zcube-cadvisor
        tags: cadvisor
      - role: homebridge
        tags: homebridge
              
          

   



       
